rm(g3.dt)
rm(g4.dt)
rm(g5.dt)
g1.str="Capital de Terceiros"
g2.str= "Capital Proprio"
g3.str= "Qualidade do Vencimento"
g4.str="Qualidade do Passivo Oneroso"
g5.str= "Grau de Endividamento"
g6.str= "Grau de Endividamento Oneroso"
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
g1.dt =as.data.frame(ind.cap.terc)
g2.dt =as.data.frame(ind.cap.prop)
g3.dt =as.data.frame(ind.qual.vencim)
g4.dt =as.data.frame(ind.pa.onero)
g5.dt =as.data.frame(ind.grau.end)
g6.dt =as.data.frame(ind.grau.end.onero)
g1.conta=c(rep(g1.str,9))
g2.conta=c(rep(g2.str,9))
g3.conta=c(rep(g3.str,9))
g4.conta=c(rep(g4.str,9))
g5.conta=c(rep(g5.str,9))
g6.conta=c(rep(g6.str,9))
g1.dt["Endiv."]=g1.conta
g2.dt["Endiv."]=g2.conta
g3.dt["Endiv."]=g3.conta
g4.dt["Endiv."]=g4.conta
g5.dt["Endiv."]=g5.conta
g6.dt["Endiv."]=g6.conta
names(g1.dt)[1]="Valor"
names(g2.dt)[1]="Valor"
names(g3.dt)[1]="Valor"
names(g4.dt)[1]="Valor"
names(g5.dt)[1]="Valor"
names(g6.dt)[1]="Valor"
Anos = paste(Anos,"0101", sep="")
g1.dt["Anos"]=Anos
g2.dt["Anos"]=Anos
g3.dt["Anos"]=Anos
g4.dt["Anos"]=Anos
g5.dt["Anos"]=Anos
g6.dt["Anos"]=Anos
g.dt=(rbind(g1.dt,g2.dt,g3.dt,g4.dt,g5.dt,g6.dt))
rownames(g.dt)=c(1:length(row.names(g.dt)))
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g1.dt$Anos = as.Date(g1.dt$Anos,"%Y%m%d")
g2.dt$Anos = as.Date(g2.dt$Anos,"%Y%m%d")
g3.dt$Anos = as.Date(g3.dt$Anos,"%Y%m%d")
g4.dt$Anos = as.Date(g4.dt$Anos,"%Y%m%d")
g5.dt$Anos = as.Date(g5.dt$Anos,"%Y%m%d")
g6.dt$Anos = as.Date(g6.dt$Anos,"%Y%m%d")
g.dt["Anos"]= Anos
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g13 =ggplot(data=g.dt, aes(x=Anos ,y = Valor, group = Endiv., colour= Endiv., shape= Endiv.))+
geom_line(col="gray70",size= 0.8, linetype = 3 )+
# scale_color_manual(breaks = c(g1.class[1], g2.class[1],
#                               g3.class[1],g4.class[1], g5.class[1]),
scale_color_manual(values=c("tomato", "cornflowerblue","springgreen3","chocolate1","orchid","cyan4"))+
labs( x="Ano", y="Indice (%)") +
ggtitle("An. de Endividamento (Estrutura de Capital)")+
scale_y_continuous(labels = function(z) paste0(z*100, " %"), breaks=seq(0,1.2,by= 0.2), limits=c(0,1.2))+
scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
geom_label_repel(
aes(x=Anos ,y = Valor, label = paste0(f.dec(Valor*100,2), " %")),
box.padding = 0.25, point.padding = 0.25,
size = 2.5, nudge_y = 0.05,
segment.color = "grey70") +
geom_point(aes(shape = Endiv.),size = 3.5, show.legend = TRUE) +
scale_shape_manual(values=c(15, 16, 17, 18, 19, 20))+
theme_bw()+
theme(panel.border = element_rect(fill=NA,color="black", size=.5, linetype="solid"),
plot.title = element_text(color="black", size=18, face="bold.italic"),
axis.title.x = element_text(color="black", size=16, face="bold"),
axis.title.y = element_text(color="black", size=16, face="bold"),
axis.text.x = element_text(face="plain", color="black", size=14, angle=0),
axis.text.y = element_text(face="plain", color="black", size=14, angle=0))
# guides(group=g.dt, col = guide_legend(nrow=1))
g13 = g13 +
theme(legend.position = c(0.30, 0.83), legend.title = element_text(size = 5.5),
legend.text = element_text(size = 5.5), legend.key.size = unit(0.5, "cm"),
legend.background = element_rect(fill="white", size=1, linetype="solid"))
print(g13)
saveplot(g13, 'g13.png')
rm(g1.dt)
rm(g2.dt)
rm(g3.dt)
rm(g4.dt)
rm(g1.conta)
rm(g2.conta)
rm(g3.conta)
rm(g4.conta)
rownames(v.juros)=c("Juros")
rownames(v.pa.onero.emp)=c("Passivo Oneroso")
rownames(v.invest)=c("Investimento (Terc + Proprio)")
g1.str= "Juros"
g2.str= "Passivo Oneroso"
g3.str= "Investimento (Terc + Proprio)"
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
g1.dt = as.data.frame(t(v.juros))
g2.dt = as.data.frame(t(v.pa.onero.emp))
g3.dt = as.data.frame(t(v.invest))
g1.conta=c(rep(g1.str,9))
g2.conta=c(rep(g2.str,9))
g3.conta=c(rep(g3.str,9))
g1.dt["Valores"]=g1.conta
g2.dt["Valores"]=g2.conta
g3.dt["Valores"]=g3.conta
names(g1.dt)[1]="Valor"
names(g2.dt)[1]="Valor"
names(g3.dt)[1]="Valor"
Anos = paste(Anos,"0101", sep="")
g1.dt["Anos"]=Anos
g2.dt["Anos"]=Anos
g3.dt["Anos"]=Anos
g.dt=(rbind(g1.dt,g2.dt,g3.dt))
rownames(g.dt)=c(1:length(row.names(g.dt)))
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g1.dt$Anos = as.Date(g1.dt$Anos,"%Y%m%d")
g2.dt$Anos = as.Date(g2.dt$Anos,"%Y%m%d")
g3.dt$Anos = as.Date(g3.dt$Anos,"%Y%m%d")
g.dt["Anos"]=Anos
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g.dt$Valores = as.factor(g.dt$Valores)
g14 = ggplot(data=g.dt, aes(x=Anos ,y = Valor, group = Valores, colour= Valores ))+
geom_line(col="gray70",size= 0.8, linetype = 3 )+
labs( x="Ano", y="Valores (Bilhões R$)") +
ggtitle("Indicadores Econômicos do Passivo da Empresa")+
scale_y_continuous(labels = function(z) paste0(z/1000000, " Bi R$"), breaks=seq(0,45000000,by= 10000000), limits=c(0,45000000))+
scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
geom_label_repel(
aes(x=Anos ,y = Valor, label = paste0(f.dec(Valor/1000000,3), " Bi")),
box.padding = 0.35, point.padding = 0.35,
size = 3, nudge_y = 0.25,
segment.color = "grey70") + geom_point(aes(shape = Valores),size = 3.5) +
scale_shape_manual(values=c(15, 16, 17)) + scale_size_manual(values=c(4, 4, 6)) + theme_bw()+
theme(panel.border = element_rect(fill=NA,color="black", size=.5, linetype="solid"),
plot.title = element_text(color="black", size=18, face="bold.italic"),
axis.title.x = element_text(color="black", size=16, face="bold"),
axis.title.y = element_text(color="black", size=16, face="bold"),
axis.text.x = element_text(face="plain", color="black", size=14, angle=0),
axis.text.y = element_text(face="plain", color="black", size=14, angle=0))
# guides(group=g.dt, col = guide_legend(nrow=1))
g14= g14 +
# scale_colour_grey(start = 0.3, end = 0.4) +
theme(legend.position = c(0.80, 0.85), legend.title = element_text(size = 8),
legend.text = element_text(size = 8), legend.key.size = unit(0.5, "cm"),
legend.background = element_rect(fill="white", size=1, linetype="solid"))
print(g14)
saveplot(g14, 'g14.png')
##########################################################
#         Análise de Lucratividade (I)
##########################################################
# Índices de Lucratividade
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
v.deprec = m.DFC.aj.cm["Depreciacao, Amortizacao e Exaustao - DFC-O",1:9]
rownames(v.deprec)=c("Depreciacao, Amortizacao e Exaustao")
v.vendas = m.DRE.aj.cm["Receita de Venda de Bens e/ou Servicos - DRE",]
rownames(v.vendas)=c("Receita de Venda de Bens e/ou Servicos")
ind.ebit= m.DRE.aj.cm["Resultado Antes do Resultado Financeiro e dos Tributos - DRE",]-
m.DRE.aj.cm["Resultado de Equivalencia Patrimonial - DRE",]-
m.DRE.aj.cm["Outras Despesas Operacionais - DRE",]-
m.DRE.aj.cm["Outras Receitas Operacionais - DRE",]
ind.ebitda= ind.ebit+v.deprec
ind.nopat= ind.ebit*(1-0.34)
rownames(ind.ebit)=c("EBIT")
rownames(ind.ebitda)=c("EBITA")
rownames(ind.nopat)=c("NOPAT")
ind.noplat= ind.nopat+v.juros*0.34 # NOPLAT= Net operating profit less adjusted taxes
rownames(ind.noplat)=c("NOPLAT")
v.marg.ebit=ind.ebit/v.vendas
v.marg.ebitda=ind.ebitda/v.vendas
v.marg.nopat=ind.nopat/v.vendas
rownames(v.marg.ebit)=c("Margem EBIT")
rownames(v.marg.ebitda)=c("Margem EBITA")
rownames(v.marg.nopat)=c("Margem NOPAT")
rownames(v.deprec)=c("Depreciacao, Amortizacao e Exaustao")
v.lliq = m.DRE.aj.cm["Lucro/Prejuizo Consolidado do Periodo - DRE",]
v.marg.liq=v.lliq/v.vendas
rownames(v.marg.liq)=c("Margem Liquida")
rm(g1.dt)
rm(g2.dt)
rm(g3.dt)
rm(g4.dt)
rm(g1.conta)
rm(g2.conta)
rm(g3.conta)
rm(g4.conta)
g1.str= "EBIT"
g2.str= "EBITDA"
g3.str= "NOPAT"
g4.str= "NOPLAT"
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
g1.dt = as.data.frame(t(ind.ebit))
g2.dt = as.data.frame(t(ind.ebitda))
g3.dt = as.data.frame(t(ind.nopat))
g4.dt = as.data.frame(t(ind.noplat))
g1.conta=c(rep(g1.str,9))
g2.conta=c(rep(g2.str,9))
g3.conta=c(rep(g3.str,9))
g4.conta=c(rep(g4.str,9))
g1.dt["Indicadores"]=g1.conta
g2.dt["Indicadores"]=g2.conta
g3.dt["Indicadores"]=g3.conta
g4.dt["Indicadores"]=g4.conta
names(g1.dt)[1]="Valor"
names(g2.dt)[1]="Valor"
names(g3.dt)[1]="Valor"
names(g4.dt)[1]="Valor"
Anos = paste(Anos,"0101", sep="")
g1.dt["Anos"]=Anos
g2.dt["Anos"]=Anos
g3.dt["Anos"]=Anos
g4.dt["Anos"]=Anos
g.dt=(rbind(g1.dt,g2.dt,g3.dt,g4.dt))
rownames(g.dt)=c(1:length(row.names(g.dt)))
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g1.dt$Anos = as.Date(g1.dt$Anos,"%Y%m%d")
g2.dt$Anos = as.Date(g2.dt$Anos,"%Y%m%d")
g3.dt$Anos = as.Date(g3.dt$Anos,"%Y%m%d")
g4.dt$Anos = as.Date(g4.dt$Anos,"%Y%m%d")
g.dt["Anos"]=Anos
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g.dt$Indicadores = as.factor(g.dt$Indicadores)
g15 = ggplot(data=g.dt, aes(x=Anos ,y = Valor, group = Indicadores, colour= Indicadores ))+
geom_line(col="gray70",size= 0.8, linetype = 3 )+
labs( x="Ano", y="Indicadores (Bilh?es R$)") +
ggtitle("Comparativo de Indicadores de Lucratividade")+
scale_y_continuous(labels = function(z) paste0(z/1000000, " Bi R$"), breaks=seq(-1000000,3800000,by= 500000), limits=c(-1000000,3800000))+
scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
geom_label_repel(
aes(x=Anos ,y = Valor, label = paste0(f.dec(Valor/1000000,3), " Bi")),
box.padding = 0.2, point.padding = 0.2,
size = 3.5, nudge_y = 0.15,
segment.color = "grey70") + geom_point(aes(shape = Indicadores),size =4.5) +
scale_shape_manual(values=c(15, 16, 17, 18)) + scale_size_manual(values=c(4, 4, 6, 6)) + theme_bw()+
theme(panel.border = element_rect(fill=NA,color="black", size=.5, linetype="solid"),
plot.title = element_text(color="black", size=18, face="bold.italic"),
axis.title.x = element_text(color="black", size=16, face="bold"),
axis.title.y = element_text(color="black", size=16, face="bold"),
axis.text.x = element_text(face="plain", color="black", size=14, angle=0),
axis.text.y = element_text(face="plain", color="black", size=14, angle=0))
# guides(group=g.dt, col = guide_legend(nrow=1))
g15= g15 +
# scale_colour_grey(start = 0.3, end = 0.4) +
theme(legend.position = c(0.60, 0.80),
legend.background = element_rect(fill="white", size=1, linetype="solid"))
print(g15)
saveplot(g14, 'g15.png')
#################################################
#     Análise da Lucratividade (III) - Margens
#################################################
rm(g1.dt)
rm(g2.dt)
rm(g3.dt)
g1.str="Margem EBIT"
g2.str= "Margem EBITDA"
g3.str= "Margem NOPAT"
g4.str= "Margem Líquida"
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
g1.dt =as.data.frame(t(v.marg.ebit))
g2.dt =as.data.frame(t(v.marg.ebitda))
g3.dt =as.data.frame(t(v.marg.nopat))
g4.dt =as.data.frame(t(v.marg.liq))
g1.conta=c(rep(g1.str,9))
g2.conta=c(rep(g2.str,9))
g3.conta=c(rep(g3.str,9))
g4.conta=c(rep(g4.str,9))
g1.dt["Margem"]=g1.conta
g2.dt["Margem"]=g2.conta
g3.dt["Margem"]=g3.conta
g4.dt["Margem"]=g4.conta
names(g1.dt)[1]="Valor"
names(g2.dt)[1]="Valor"
names(g3.dt)[1]="Valor"
names(g4.dt)[1]="Valor"
Anos = paste(Anos,"0101", sep="")
g1.dt["Anos"]=Anos
g2.dt["Anos"]=Anos
g3.dt["Anos"]=Anos
g4.dt["Anos"]=Anos
g.dt=(rbind(g1.dt,g2.dt,g3.dt,g4.dt))
rownames(g.dt)=c(1:length(row.names(g.dt)))
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g1.dt$Anos = as.Date(g1.dt$Anos,"%Y%m%d")
g2.dt$Anos = as.Date(g2.dt$Anos,"%Y%m%d")
g3.dt$Anos = as.Date(g3.dt$Anos,"%Y%m%d")
g4.dt$Anos = as.Date(g4.dt$Anos,"%Y%m%d")
g.dt["Anos"]=Anos
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g.dt$Contas = as.factor(g.dt$Margem)
g16 = ggplot(data=g.dt, aes(x=Anos ,y = Valor, group = Margem, colour= Margem ))+
geom_line(col="gray70",size= 0.8, linetype = 3 )+
labs( x="Ano", y="Margens %") +
ggtitle("Margem na Lucratividade")+
scale_y_continuous(labels = function(z) paste0(z*100, "%"), breaks=seq(-0.15,0.3,by=0.10), limits=c(-0.15,0.3))+
scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
geom_label_repel(
aes(x=Anos ,y = Valor, label = paste0(f.dec(Valor*100,2), "%")),
box.padding = 0.2, point.padding = 0.2,
size = 3.5, nudge_y = 0.05,
segment.color = "grey70") + geom_point(aes(shape = Margem),size =4.0) +
scale_shape_manual(values=c(15, 16, 17,18)) + scale_size_manual(values=c(4, 4, 6, 4)) + theme_bw()+
theme(panel.border = element_rect(fill=NA,color="black", size=.5, linetype="solid"),
plot.title = element_text(color="black", size=18, face="bold.italic"),
axis.title.x = element_text(color="black", size=16, face="bold"),
axis.title.y = element_text(color="black", size=16, face="bold"),
axis.text.x = element_text(face="plain", color="black", size=14, angle=0),
axis.text.y = element_text(face="plain", color="black", size=14, angle=0))
g16= g16 +
#   scale_colour_grey(start = 0.3, end = 0.4) +
theme(legend.position = c(0.13, 0.17), legend.key.size = unit(0.5, "cm"),
legend.background = element_rect(fill="white", size=1, linetype="solid"))
print(g16)
saveplot(g16, 'g16.png')
print(g15)
print(g16)
##########################################################
#           Análise de Rentabilidade
##########################################################
v.PL.aj=m.Passivo.aj.med["Patrimonio Liquido Consolidado - PL",]
rownames(v.PL.aj)=c("Patrimonio Liquido Consolidado - PL")
at.ciclico=t(at.ciclico)
ind.roa=v.lliq/v.AT.aj
ind.roe=v.lliq/v.PL.aj
ind.roi=ind.ebit/at.ciclico
rownames(ind.roa)=c("ROA")
rownames(ind.roe)=c("ROE")
rownames(ind.roi)=c("ROI")
ind.giro.op=v.vendas/at.ciclico
ind.giro.at=v.vendas/v.AT.aj
ind.giro.pl=v.vendas/v.PL.aj
rownames(ind.giro.op)=c("Giro Operacional")
rownames(ind.giro.at)=c("Giro do Ativo")
rownames(ind.giro.pl)=c("Giro do PL")
# Visualizando
rm(g1.dt)
rm(g2.dt)
rm(g3.dt)
g1.str="ROA"
g2.str= "ROE"
g3.str= "ROI"
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
g1.dt =as.data.frame(t(ind.roa))
g2.dt =as.data.frame(t(ind.roe))
g3.dt =as.data.frame(t(ind.roi))
g1.conta=c(rep(g1.str,9))
g2.conta=c(rep(g2.str,9))
g3.conta=c(rep(g3.str,9))
g1.dt["Indicadores"]=g1.conta
g2.dt["Indicadores"]=g2.conta
g3.dt["Indicadores"]=g3.conta
names(g1.dt)[1]="Valor"
names(g2.dt)[1]="Valor"
names(g3.dt)[1]="Valor"
Anos = paste(Anos,"0101", sep="")
g1.dt["Anos"]=Anos
g2.dt["Anos"]=Anos
g3.dt["Anos"]=Anos
g.dt=(rbind(g1.dt,g2.dt,g3.dt))
rownames(g.dt)=c(1:length(row.names(g.dt)))
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g1.dt$Anos = as.Date(g1.dt$Anos,"%Y%m%d")
g2.dt$Anos = as.Date(g2.dt$Anos,"%Y%m%d")
g3.dt$Anos = as.Date(g3.dt$Anos,"%Y%m%d")
g.dt["Anos"]=Anos
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g.dt$Contas = as.factor(g.dt$Indicadores)
g17 = ggplot(data=g.dt, aes(x=Anos ,y = Valor, group = Indicadores, colour= Indicadores ))+
geom_line(col="gray70",size= 0.8, linetype = 3 )+
labs( x="Ano", y="Indicadores %") +
ggtitle("Indicadores de Rentabilidade")+
scale_y_continuous(labels = function(z) paste0(z*100, "%"), breaks=seq(-0.25,0.3,by=0.10), limits=c(-0.25,0.3))+
scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
geom_label_repel(
aes(x=Anos ,y = Valor, label = paste0(f.dec(Valor*100,2), "%")),
box.padding = 0.2, point.padding = 0.2,
size = 3.5, nudge_y = 0.05,
segment.color = "grey70") + geom_point(aes(shape = Indicadores),size =4.5) +
scale_shape_manual(values=c(15, 16, 17,18)) + scale_size_manual(values=c(4, 4, 6, 4)) + theme_bw()+
theme(panel.border = element_rect(fill=NA,color="black", size=.5, linetype="solid"),
plot.title = element_text(color="black", size=18, face="bold.italic"),
axis.title.x = element_text(color="black", size=16, face="bold"),
axis.title.y = element_text(color="black", size=16, face="bold"),
axis.text.x = element_text(face="plain", color="black", size=14, angle=0),
axis.text.y = element_text(face="plain", color="black", size=14, angle=0))
g17= g17 +
#   scale_colour_grey(start = 0.3, end = 0.4) +
theme(legend.position = c(0.15, 0.20),
legend.background = element_rect(fill="white", size=1, linetype="solid"))
print(g17)
saveplot(g17, 'g17.png')
rm(g1.dt)
rm(g2.dt)
rm(g3.dt)
g1.str="Margem EBIT"
g2.str= "Margem EBITDA"
g3.str= "Margem NOPAT"
g4.str= "Margem Líquida"
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
g1.dt =as.data.frame(t(v.marg.ebit))
g2.dt =as.data.frame(t(v.marg.ebitda))
g3.dt =as.data.frame(t(v.marg.nopat))
g4.dt =as.data.frame(t(v.marg.liq))
g1.conta=c(rep(g1.str,9))
g2.conta=c(rep(g2.str,9))
g3.conta=c(rep(g3.str,9))
g4.conta=c(rep(g4.str,9))
g1.dt["Margem"]=g1.conta
g2.dt["Margem"]=g2.conta
g3.dt["Margem"]=g3.conta
g4.dt["Margem"]=g4.conta
names(g1.dt)[1]="Valor"
names(g2.dt)[1]="Valor"
names(g3.dt)[1]="Valor"
names(g4.dt)[1]="Valor"
Anos = paste(Anos,"0101", sep="")
g1.dt["Anos"]=Anos
g2.dt["Anos"]=Anos
g3.dt["Anos"]=Anos
g4.dt["Anos"]=Anos
g.dt=(rbind(g1.dt,g2.dt,g3.dt,g4.dt))
rownames(g.dt)=c(1:length(row.names(g.dt)))
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g1.dt$Anos = as.Date(g1.dt$Anos,"%Y%m%d")
g2.dt$Anos = as.Date(g2.dt$Anos,"%Y%m%d")
g3.dt$Anos = as.Date(g3.dt$Anos,"%Y%m%d")
g4.dt$Anos = as.Date(g4.dt$Anos,"%Y%m%d")
g.dt["Anos"]=Anos
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g.dt$Contas = as.factor(g.dt$Margem)
g18 = ggplot(data=g.dt, aes(x=Anos ,y = Valor, group = Margem, colour= Margem ))+
geom_line(col="gray70",size= 0.8, linetype = 3 )+
labs( x="Ano", y="Margens %") +
ggtitle("Margem da Rentabilidade")+
scale_y_continuous(labels = function(z) paste0(z*100, "%"), breaks=seq(-0.15,0.3,by=0.10), limits=c(-0.15,0.3))+
scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
geom_label_repel(
aes(x=Anos ,y = Valor, label = paste0(f.dec(Valor*100,2), "%")),
box.padding = 0.2, point.padding = 0.2,
size = 3.5, nudge_y = 0.05,
segment.color = "grey70") + geom_point(aes(shape = Margem),size =4.5) +
scale_shape_manual(values=c(15, 16, 17,18)) + scale_size_manual(values=c(4, 4, 6, 4)) + theme_bw()+
theme(panel.border = element_rect(fill=NA,color="black", size=.5, linetype="solid"),
plot.title = element_text(color="black", size=18, face="bold.italic"),
axis.title.x = element_text(color="black", size=16, face="bold"),
axis.title.y = element_text(color="black", size=16, face="bold"),
axis.text.x = element_text(face="plain", color="black", size=14, angle=0),
axis.text.y = element_text(face="plain", color="black", size=14, angle=0))
g18= g18 +
#   scale_colour_grey(start = 0.3, end = 0.4) +
theme(legend.position = c(0.55, 0.80), legend.title = element_text(size = 7),
legend.text = element_text(size = 7), legend.key.size = unit(0.6, "cm"),
legend.background = element_rect(fill="white", size=1, linetype="solid"))
print(g18)
saveplot(g18, 'g18.png')
# Visualizando Giros
rm(g1.dt)
rm(g2.dt)
rm(g3.dt)
g1.str="Giro do Ativo"
g2.str= "Giro Operacional"
g3.str= "Giro do PL"
Anos=c("2018","2017","2016","2015","2014","2013","2012","2011","2010")
g1.dt =as.data.frame(t(ind.giro.at))
g2.dt =as.data.frame(t(ind.giro.op))
g3.dt =as.data.frame(t(ind.giro.pl))
g1.conta=c(rep(g1.str,9))
g2.conta=c(rep(g2.str,9))
g3.conta=c(rep(g3.str,9))
g1.dt["Indicadores"]=g1.conta
g2.dt["Indicadores"]=g2.conta
g3.dt["Indicadores"]=g3.conta
names(g1.dt)[1]="Valor"
names(g2.dt)[1]="Valor"
names(g3.dt)[1]="Valor"
Anos = paste(Anos,"0101", sep="")
g1.dt["Anos"]=Anos
g2.dt["Anos"]=Anos
g3.dt["Anos"]=Anos
g.dt=(rbind(g1.dt,g2.dt,g3.dt))
rownames(g.dt)=c(1:length(row.names(g.dt)))
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g1.dt$Anos = as.Date(g1.dt$Anos,"%Y%m%d")
g2.dt$Anos = as.Date(g2.dt$Anos,"%Y%m%d")
g3.dt$Anos = as.Date(g3.dt$Anos,"%Y%m%d")
g.dt["Anos"]=Anos
g.dt$Anos = as.Date(g.dt$Anos,"%Y%m%d")
g.dt$Contas = as.factor(g.dt$Indicadores)
g19 = ggplot(data=g.dt, aes(x=Anos ,y = Valor, group = Indicadores, colour= Indicadores ))+
geom_line(col="gray70",size= 0.8, linetype = 3 )+
labs( x="Ano", y="Giro Operacional, do Ativo e do PL") +
ggtitle("Indicadores de Desempenho Econômico")+
scale_y_continuous(labels = function(z) paste0(z*1, " "), breaks=seq(0.0,3,by=0.5), limits=c(0.0,3))+
scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
geom_label_repel(
aes(x=Anos ,y = Valor, label = paste0(f.dec(Valor*1,2), " ")),
box.padding = 0.2, point.padding = 0.2,
size = 3.0, nudge_y = 0.05,
segment.color = "grey70") + geom_point(aes(shape = Indicadores),size =4.0) +
scale_shape_manual(values=c(15, 16, 17,18)) + scale_size_manual(values=c(4, 4, 6, 4)) + theme_bw()+
theme(panel.border = element_rect(fill=NA,color="black", size=.5, linetype="solid"),
plot.title = element_text(color="black", size=18, face="bold.italic"),
axis.title.x = element_text(color="black", size=16, face="bold"),
axis.title.y = element_text(color="black", size=16, face="bold"),
axis.text.x = element_text(face="plain", color="black", size=14, angle=0),
axis.text.y = element_text(face="plain", color="black", size=14, angle=0))
g19= g19 +
#   scale_colour_grey(start = 0.3, end = 0.4) +
theme(legend.position = c(0.25, 0.85), legend.title = element_text(size = 7),
legend.text = element_text(size = 7), legend.key.size = unit(0.6, "cm"),
legend.background = element_rect(fill="white", size=1, linetype="solid"))
print(g19)
saveplot(g19,'g19.png')
